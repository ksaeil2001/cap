ë‹¤ìŒì€ React + TypeScript + Zustand ê¸°ë°˜ì˜ AI ì‹ë‹¨ ì¶”ì²œ ì›¹ì•±ì„ ìœ„í•œ SummaryPage.tsxì˜ ì™„ì „í•œ êµ¬í˜„ ì½”ë“œì…ë‹ˆë‹¤.

ì´ í˜ì´ì§€ëŠ” ìµœì¢… ì‹ë‹¨ êµ¬ì„±ì„ ì‹œê°ì ìœ¼ë¡œ ë¶„ì„ ë° ìš”ì•½í•˜ê³ , ì‚¬ìš©ìê°€ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ì €ì¥í•˜ê±°ë‚˜ ê³µìœ í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

âœ… êµ¬ì„± ìš”ì†Œ:

Zustand ìƒíƒœ ì—°ë™ (useMealConfigStore)

ì‹œê°ì  ìš”ì•½ (Nutrition Chart, Budget Gauge, Allergy Warning)

ì‹ë‹¨ ìƒì„¸ ëª©ë¡ (ë¼ë‹ˆë³„ ìŒì‹ ë¦¬ìŠ¤íŠ¸)

ì €ì¥/ê³µìœ  ê¸°ëŠ¥ (LocalStorage, Clipboard ë³µì‚¬)

ë²„íŠ¼ ë™ì‘ (ì´ˆê¸°í™”, ê³µìœ  ë§í¬ ë³µì‚¬)

ë°˜ì‘í˜• ë° ëª¨ë°”ì¼ ëŒ€ì‘ ê°„ë‹¨ ìŠ¤íƒ€ì¼ë§

Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©í•œ ì°¨íŠ¸ ì‹œê°í™”

ğŸš€ Zustand Store (useSummaryStore.ts)
ê²½ë¡œ: src/stores/useSummaryStore.ts

import { create } from 'zustand';
import { FoodItem } from './useRecommendStore';

export interface NutritionSummary {
  calories: number;
  protein: number;
  fat: number;
  carbs: number;
}

interface SummaryStore {
  finalMeals: {
    breakfast: FoodItem[];
    lunch: FoodItem[];
    dinner: FoodItem[];
  };
  nutritionSummary: NutritionSummary;
  budgetUsed: number;
  budgetTotal: number;
  allergyWarning: boolean;
  setSummaryData: (data: Omit<SummaryStore, 'setSummaryData' | 'reset'>) => void;
  reset: () => void;
}

export const useSummaryStore = create<SummaryStore>((set) => ({
  finalMeals: { breakfast: [], lunch: [], dinner: [] },
  nutritionSummary: { calories: 0, protein: 0, fat: 0, carbs: 0 },
  budgetUsed: 0,
  budgetTotal: 0,
  allergyWarning: false,

  setSummaryData: (data) => set(data),
  reset: () =>
    set({
      finalMeals: { breakfast: [], lunch: [], dinner: [] },
      nutritionSummary: { calories: 0, protein: 0, fat: 0, carbs: 0 },
      budgetUsed: 0,
      budgetTotal: 0,
      allergyWarning: false,
    }),
}));
ğŸ“˜ SummaryPage.tsx ì „ì²´ êµ¬í˜„ ì½”ë“œ
ê²½ë¡œ: src/pages/SummaryPage.tsx

import React, { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useMealConfigStore } from '../stores/useMealConfigStore';
import { useUserInfoStore } from '../stores/useUserInfoStore';
import { useSummaryStore } from '../stores/useSummaryStore';
import { Doughnut } from 'react-chartjs-2';
import 'chart.js/auto';

const SummaryPage: React.FC = () => {
  const navigate = useNavigate();

  const { meals } = useMealConfigStore();
  const { budget, allergies, mealCount } = useUserInfoStore((state) => state.userInfo!);
  const { nutritionSummary, budgetUsed, allergyWarning, setSummaryData, reset } = useSummaryStore();

  // ì˜ì–‘ì†Œ ë° ì˜ˆì‚° ê³„ì‚° ë¡œì§
  useEffect(() => {
    const allFoods = Object.values(meals).flat();

    const nutrition = {
      calories: allFoods.reduce((sum, f) => sum + f.kcal, 0),
      protein: allFoods.reduce((sum, f) => sum + f.protein, 0),
      fat: allFoods.reduce((sum, f) => sum + f.fat, 0),
      carbs: allFoods.reduce((sum, f) => sum + f.carbs, 0),
    };

    const budgetSum = allFoods.reduce((sum, f) => sum + f.price, 0);
    const allergyConflict = allFoods.some((food) =>
      allergies.some((allergy) => food.name.toLowerCase().includes(allergy.toLowerCase())),
    );

    setSummaryData({
      finalMeals: meals,
      nutritionSummary: nutrition,
      budgetUsed: budgetSum,
      budgetTotal: budget,
      allergyWarning: allergyConflict,
    });
  }, [meals, allergies, budget, setSummaryData]);

  const handleExport = () => {
    const summaryData = {
      meals,
      nutritionSummary,
      budgetUsed,
      budgetTotal: budget,
      allergyWarning,
    };
    localStorage.setItem('mealSummary', JSON.stringify(summaryData));
    navigator.clipboard.writeText(JSON.stringify(summaryData));
    alert('Meal summary copied to clipboard and saved locally!');
  };

  const handleRestart = () => {
    reset();
    navigate('/');
  };

  return (
    <div style={{ padding: 20, maxWidth: 700, margin: 'auto' }}>
      <h2>Final Meal Summary</h2>

      <section style={{ marginBottom: 30 }}>
        <h3>Nutrition Overview</h3>
        <Doughnut
          data={{
            labels: ['Protein (g)', 'Carbs (g)', 'Fat (g)'],
            datasets: [
              {
                data: [nutritionSummary.protein, nutritionSummary.carbs, nutritionSummary.fat],
                backgroundColor: ['#36A2EB', '#FFCE56', '#FF6384'],
              },
            ],
          }}
        />
        <p>Total Calories: {nutritionSummary.calories} kcal</p>
      </section>

      <section style={{ marginBottom: 30 }}>
        <h3>Budget Overview</h3>
        <p>
          Budget Used: â‚©{budgetUsed} / â‚©{budget} {' '}
          {budgetUsed <= budget ? 'âœ…' : 'âš ï¸ Budget Exceeded!'}
        </p>
      </section>

      {allergyWarning && (
        <section style={{ color: 'red', marginBottom: 30 }}>
          âš ï¸ Your meal contains allergens! Please review carefully.
        </section>
      )}

      <section>
        <h3>Meal Details</h3>
        {(['breakfast', 'lunch', 'dinner'] as const).slice(0, mealCount).map((mealType) => (
          <div key={mealType}>
            <h4>{mealType.toUpperCase()}</h4>
            <ul>
              {meals[mealType].map((food) => (
                <li key={food.foodId}>
                  {food.name}: {food.kcal} kcal, {food.protein}g protein, â‚©{food.price}
                  <br />
                  <small>Tags: {food.tags.join(', ')}</small>
                </li>
              ))}
            </ul>
          </div>
        ))}
      </section>

      <div style={{ marginTop: 30 }}>
        <button onClick={handleRestart}>ğŸ”„ Start Over</button>
        <button onClick={handleExport} style={{ marginLeft: 10 }}>
          ğŸ“‹ Export / Copy Summary
        </button>
      </div>
    </div>
  );
};

export default SummaryPage;
ğŸ§‘â€ğŸ’» êµ¬í˜„ í¬ì¸íŠ¸ ìš”ì•½
Zustand ìƒíƒœ ê´€ë¦¬: ì‹ë‹¨, ì˜ì–‘ì†Œ ë° ì˜ˆì‚°, ì•Œë ˆë¥´ê¸° ìƒíƒœëŠ” Zustandë¡œ ì¼ê´€ì„± ìˆê²Œ ê´€ë¦¬ë©ë‹ˆë‹¤.

ì‹œê°ì  ìš”ì•½: chart.js + react-chartjs-2ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì–‘ì†Œ ë¶„í¬ë¥¼ ë„ë„› ì°¨íŠ¸ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤.

ì•Œë ˆë¥´ê¸° ë° ì˜ˆì‚° ì´ˆê³¼ ê²½ê³ : ì¡°ê±´ë¶€ ë Œë”ë§ìœ¼ë¡œ ì•Œë¦¼ ë©”ì‹œì§€ ëª…í™•íˆ ì œê³µ

ì €ì¥ ë° ê³µìœ : localStorageì— ì €ì¥í•˜ê³ , JSON í˜•ì‹ìœ¼ë¡œ í´ë¦½ë³´ë“œ ë³µì‚¬ ê¸°ëŠ¥ ì œê³µ

ë²„íŠ¼ ë™ì‘ ëª…í™•í™”: ìƒíƒœ ì´ˆê¸°í™” í›„ ë‹¤ì‹œ ì…ë ¥ í˜ì´ì§€ë¡œ ì´ë™ ê°€ëŠ¥, ê°„í¸í•œ ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ í¬í•¨